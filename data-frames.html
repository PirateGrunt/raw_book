<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>raw - R Actuarial Workshops</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This is a companion to actuarial workshops.">
  <meta name="generator" content="bookdown 0.1 and GitBook 2.6.7">

  <meta property="og:title" content="raw - R Actuarial Workshops" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="raw_cover.png" />
  <meta property="og:description" content="This is a companion to actuarial workshops." />
  <meta name="github-repo" content="PirateGrunt/raw_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="raw - R Actuarial Workshops" />
  
  <meta name="twitter:description" content="This is a companion to actuarial workshops." />
  <meta name="twitter:image" content="raw_cover.png" />

<meta name="author" content="Brian A. Fannin, ACAS">

<meta name="date" content="2016-09-11">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="lists.html">
<link rel="next" href="references.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="first-steps.html"><a href="first-steps.html"><i class="fa fa-check"></i>First Steps</a></li>
<li class="chapter" data-level="1" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>1</b> Setup</a><ul>
<li class="chapter" data-level="1.1" data-path="setup.html"><a href="setup.html#installing-r"><i class="fa fa-check"></i><b>1.1</b> Installing R</a><ul>
<li class="chapter" data-level="1.1.1" data-path="setup.html"><a href="setup.html#operating-systems"><i class="fa fa-check"></i><b>1.1.1</b> Operating systems</a></li>
<li class="chapter" data-level="1.1.2" data-path="setup.html"><a href="setup.html#bitness"><i class="fa fa-check"></i><b>1.1.2</b> Bitness</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="setup.html"><a href="setup.html#installing-r-studio"><i class="fa fa-check"></i><b>1.2</b> Installing R Studio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="setup.html"><a href="setup.html#it"><i class="fa fa-check"></i><b>1.2.1</b> IT</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="setup.html"><a href="setup.html#conclusion"><i class="fa fa-check"></i><b>1.3</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting started</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#the-operating-environment"><i class="fa fa-check"></i><b>2.1</b> The Operating Environment</a><ul>
<li class="chapter" data-level="2.1.1" data-path="getting-started.html"><a href="getting-started.html#command-line-interface"><i class="fa fa-check"></i><b>2.1.1</b> Command-line interface</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#entering-commands"><i class="fa fa-check"></i><b>2.2</b> Entering Commands</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started.html"><a href="getting-started.html#your-first-script"><i class="fa fa-check"></i><b>2.3</b> Your first script</a><ul>
<li class="chapter" data-level="2.3.1" data-path="getting-started.html"><a href="getting-started.html#executing-a-script"><i class="fa fa-check"></i><b>2.3.1</b> Executing a script</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="getting-started.html"><a href="getting-started.html#getting-help"><i class="fa fa-check"></i><b>2.4</b> Getting help</a></li>
<li class="chapter" data-level="2.5" data-path="getting-started.html"><a href="getting-started.html#the-working-directory"><i class="fa fa-check"></i><b>2.5</b> The working directory</a><ul>
<li class="chapter" data-level="2.5.1" data-path="getting-started.html"><a href="getting-started.html#directory-paths"><i class="fa fa-check"></i><b>2.5.1</b> Directory paths</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="elements-of-the-language.html"><a href="elements-of-the-language.html"><i class="fa fa-check"></i><b>3</b> Elements of the Language</a><ul>
<li class="chapter" data-level="3.1" data-path="elements-of-the-language.html"><a href="elements-of-the-language.html#variables"><i class="fa fa-check"></i><b>3.1</b> Variables</a><ul>
<li class="chapter" data-level="3.1.1" data-path="elements-of-the-language.html"><a href="elements-of-the-language.html#assignment"><i class="fa fa-check"></i><b>3.1.1</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="elements-of-the-language.html"><a href="elements-of-the-language.html#operators"><i class="fa fa-check"></i><b>3.2</b> Operators</a><ul>
<li class="chapter" data-level="3.2.1" data-path="elements-of-the-language.html"><a href="elements-of-the-language.html#mathematical-operators"><i class="fa fa-check"></i><b>3.2.1</b> Mathematical Operators</a></li>
<li class="chapter" data-level="3.2.2" data-path="elements-of-the-language.html"><a href="elements-of-the-language.html#logical-operators"><i class="fa fa-check"></i><b>3.2.2</b> Logical Operators</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="elements-of-the-language.html"><a href="elements-of-the-language.html#functions"><i class="fa fa-check"></i><b>3.3</b> Functions</a><ul>
<li class="chapter" data-level="3.3.1" data-path="elements-of-the-language.html"><a href="elements-of-the-language.html#a-few-mathematical-functions"><i class="fa fa-check"></i><b>3.3.1</b> A few mathematical functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="elements-of-the-language.html"><a href="elements-of-the-language.html#comments"><i class="fa fa-check"></i><b>3.4</b> Comments</a><ul>
<li class="chapter" data-level="3.4.1" data-path="elements-of-the-language.html"><a href="elements-of-the-language.html#bad-comment"><i class="fa fa-check"></i><b>3.4.1</b> Bad comment</a></li>
<li class="chapter" data-level="3.4.2" data-path="elements-of-the-language.html"><a href="elements-of-the-language.html#good-comment"><i class="fa fa-check"></i><b>3.4.2</b> Good comment</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="elements-of-the-language.html"><a href="elements-of-the-language.html#exercises"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="4" data-path="chap-data-types.html"><a href="chap-data-types.html"><i class="fa fa-check"></i><b>4</b> Data types</a><ul>
<li class="chapter" data-level="4.1" data-path="chap-data-types.html"><a href="chap-data-types.html#data-types"><i class="fa fa-check"></i><b>4.1</b> Data types</a></li>
<li class="chapter" data-level="4.2" data-path="chap-data-types.html"><a href="chap-data-types.html#data-conversion"><i class="fa fa-check"></i><b>4.2</b> Data conversion</a></li>
<li class="chapter" data-level="4.3" data-path="chap-data-types.html"><a href="chap-data-types.html#dates-and-times"><i class="fa fa-check"></i><b>4.3</b> Dates and times</a></li>
<li class="chapter" data-level="4.4" data-path="chap-data-types.html"><a href="chap-data-types.html#factors"><i class="fa fa-check"></i><b>4.4</b> Factors</a></li>
<li class="chapter" data-level="4.5" data-path="chap-data-types.html"><a href="chap-data-types.html#exercises-1"><i class="fa fa-check"></i><b>4.5</b> Exercises</a><ul>
<li class="chapter" data-level="4.5.1" data-path="chap-data-types.html"><a href="chap-data-types.html#answers"><i class="fa fa-check"></i><b>4.5.1</b> Answers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-vectors.html"><a href="chap-vectors.html"><i class="fa fa-check"></i><b>5</b> Vectors</a><ul>
<li class="chapter" data-level="5.1" data-path="chap-vectors.html"><a href="chap-vectors.html#what-is-a-vector"><i class="fa fa-check"></i><b>5.1</b> What is a vector?</a><ul>
<li class="chapter" data-level="5.1.1" data-path="chap-vectors.html"><a href="chap-vectors.html#vector-properties"><i class="fa fa-check"></i><b>5.1.1</b> Vector properties</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chap-vectors.html"><a href="chap-vectors.html#vector-construction"><i class="fa fa-check"></i><b>5.2</b> Vector construction</a><ul>
<li class="chapter" data-level="5.2.1" data-path="chap-vectors.html"><a href="chap-vectors.html#seq"><i class="fa fa-check"></i><b>5.2.1</b> <code>seq</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="chap-vectors.html"><a href="chap-vectors.html#rep"><i class="fa fa-check"></i><b>5.2.2</b> <code>rep</code></a></li>
<li class="chapter" data-level="5.2.3" data-path="chap-vectors.html"><a href="chap-vectors.html#c"><i class="fa fa-check"></i><b>5.2.3</b> <code>c</code></a></li>
<li class="chapter" data-level="5.2.4" data-path="chap-vectors.html"><a href="chap-vectors.html#paste"><i class="fa fa-check"></i><b>5.2.4</b> <code>paste</code></a></li>
<li class="chapter" data-level="5.2.5" data-path="chap-vectors.html"><a href="chap-vectors.html#sample"><i class="fa fa-check"></i><b>5.2.5</b> <code>sample</code></a></li>
<li class="chapter" data-level="5.2.6" data-path="chap-vectors.html"><a href="chap-vectors.html#sort"><i class="fa fa-check"></i><b>5.2.6</b> <code>sort</code></a></li>
<li class="chapter" data-level="5.2.7" data-path="chap-vectors.html"><a href="chap-vectors.html#vector"><i class="fa fa-check"></i><b>5.2.7</b> <code>vector</code></a></li>
<li class="chapter" data-level="5.2.8" data-path="chap-vectors.html"><a href="chap-vectors.html#recycling"><i class="fa fa-check"></i><b>5.2.8</b> Recycling</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chap-vectors.html"><a href="chap-vectors.html#vector-access"><i class="fa fa-check"></i><b>5.3</b> Vector access</a><ul>
<li class="chapter" data-level="5.3.1" data-path="chap-vectors.html"><a href="chap-vectors.html#headtail"><i class="fa fa-check"></i><b>5.3.1</b> <code>head</code>/<code>tail</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="chap-vectors.html"><a href="chap-vectors.html#vector-access---logical-access"><i class="fa fa-check"></i><b>5.3.2</b> Vector access - logical access</a></li>
<li class="chapter" data-level="5.3.3" data-path="chap-vectors.html"><a href="chap-vectors.html#which"><i class="fa fa-check"></i><b>5.3.3</b> <code>which</code></a></li>
<li class="chapter" data-level="5.3.4" data-path="chap-vectors.html"><a href="chap-vectors.html#order"><i class="fa fa-check"></i><b>5.3.4</b> <code>order</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chap-vectors.html"><a href="chap-vectors.html#set-theory"><i class="fa fa-check"></i><b>5.4</b> Set theory</a></li>
<li class="chapter" data-level="5.5" data-path="chap-vectors.html"><a href="chap-vectors.html#assignment-1"><i class="fa fa-check"></i><b>5.5</b> Assignment</a><ul>
<li class="chapter" data-level="5.5.1" data-path="chap-vectors.html"><a href="chap-vectors.html#growth-by-assignment"><i class="fa fa-check"></i><b>5.5.1</b> Growth by assignment</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="chap-vectors.html"><a href="chap-vectors.html#metadata"><i class="fa fa-check"></i><b>5.6</b> Metadata</a><ul>
<li class="chapter" data-level="5.6.1" data-path="chap-vectors.html"><a href="chap-vectors.html#length-dim"><i class="fa fa-check"></i><b>5.6.1</b> <code>length</code>, <code>dim</code></a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="chap-vectors.html"><a href="chap-vectors.html#summarization"><i class="fa fa-check"></i><b>5.7</b> Summarization</a></li>
<li class="chapter" data-level="5.8" data-path="chap-vectors.html"><a href="chap-vectors.html#matrices"><i class="fa fa-check"></i><b>5.8</b> Matrices</a><ul>
<li class="chapter" data-level="5.8.1" data-path="chap-vectors.html"><a href="chap-vectors.html#section"><i class="fa fa-check"></i><b>5.8.1</b> </a></li>
<li class="chapter" data-level="5.8.2" data-path="chap-vectors.html"><a href="chap-vectors.html#matrix-metadata"><i class="fa fa-check"></i><b>5.8.2</b> Matrix metadata</a></li>
<li class="chapter" data-level="5.8.3" data-path="chap-vectors.html"><a href="chap-vectors.html#matrix-access"><i class="fa fa-check"></i><b>5.8.3</b> Matrix access</a></li>
<li class="chapter" data-level="5.8.4" data-path="chap-vectors.html"><a href="chap-vectors.html#matrix-summarizatioon"><i class="fa fa-check"></i><b>5.8.4</b> Matrix summarizatioon</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="chap-vectors.html"><a href="chap-vectors.html#arrays"><i class="fa fa-check"></i><b>5.9</b> Arrays</a></li>
<li class="chapter" data-level="5.10" data-path="chap-vectors.html"><a href="chap-vectors.html#exercises-2"><i class="fa fa-check"></i><b>5.10</b> Exercises</a></li>
<li class="chapter" data-level="5.11" data-path="chap-vectors.html"><a href="chap-vectors.html#answers-1"><i class="fa fa-check"></i><b>5.11</b> Answers</a></li>
<li class="chapter" data-level="5.12" data-path="chap-vectors.html"><a href="chap-vectors.html#conclusion-1"><i class="fa fa-check"></i><b>5.12</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lists.html"><a href="lists.html"><i class="fa fa-check"></i><b>6</b> Lists</a><ul>
<li class="chapter" data-level="6.1" data-path="lists.html"><a href="lists.html#lists-overview"><i class="fa fa-check"></i><b>6.1</b> Lists Overview</a></li>
<li class="chapter" data-level="6.2" data-path="lists.html"><a href="lists.html#list-construction"><i class="fa fa-check"></i><b>6.2</b> List construction</a><ul>
<li class="chapter" data-level="6.2.1" data-path="lists.html"><a href="lists.html#recursive-storage"><i class="fa fa-check"></i><b>6.2.1</b> Recursive storage</a></li>
<li class="chapter" data-level="6.2.2" data-path="lists.html"><a href="lists.html#list-metadata"><i class="fa fa-check"></i><b>6.2.2</b> List metadata</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lists.html"><a href="lists.html#access-and-assignment"><i class="fa fa-check"></i><b>6.3</b> Access and assignment</a><ul>
<li class="chapter" data-level="6.3.1" data-path="lists.html"><a href="lists.html#vs."><i class="fa fa-check"></i><b>6.3.1</b> [ vs. [[</a></li>
<li class="chapter" data-level="6.3.2" data-path="lists.html"><a href="lists.html#assignment-2"><i class="fa fa-check"></i><b>6.3.2</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="lists.html"><a href="lists.html#summary-functions"><i class="fa fa-check"></i><b>6.4</b> Summary functions</a></li>
<li class="chapter" data-level="6.5" data-path="lists.html"><a href="lists.html#exercises-3"><i class="fa fa-check"></i><b>6.5</b> Exercises</a></li>
<li class="chapter" data-level="6.6" data-path="lists.html"><a href="lists.html#answers-2"><i class="fa fa-check"></i><b>6.6</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>7</b> Data Frames</a><ul>
<li class="chapter" data-level="7.1" data-path="data-frames.html"><a href="data-frames.html#whats-a-data-frame"><i class="fa fa-check"></i><b>7.1</b> What’s a data frame?</a><ul>
<li class="chapter" data-level="7.1.1" data-path="data-frames.html"><a href="data-frames.html#creating-a-data-frame"><i class="fa fa-check"></i><b>7.1.1</b> Creating a data frame</a></li>
<li class="chapter" data-level="7.1.2" data-path="data-frames.html"><a href="data-frames.html#basic-properties-of-a-data-frame"><i class="fa fa-check"></i><b>7.1.2</b> Basic properties of a data frame</a></li>
<li class="chapter" data-level="7.1.3" data-path="data-frames.html"><a href="data-frames.html#combining-data-frames"><i class="fa fa-check"></i><b>7.1.3</b> Combining data frames</a></li>
<li class="chapter" data-level="7.1.4" data-path="data-frames.html"><a href="data-frames.html#expand.grid"><i class="fa fa-check"></i><b>7.1.4</b> <code>expand.grid</code></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="data-frames.html"><a href="data-frames.html#access-and-assignment-1"><i class="fa fa-check"></i><b>7.2</b> Access and Assignment</a><ul>
<li class="chapter" data-level="7.2.1" data-path="data-frames.html"><a href="data-frames.html#subsetting"><i class="fa fa-check"></i><b>7.2.1</b> Subsetting</a></li>
<li class="chapter" data-level="7.2.2" data-path="data-frames.html"><a href="data-frames.html#altering-and-adding-columns"><i class="fa fa-check"></i><b>7.2.2</b> Altering and adding columns</a></li>
<li class="chapter" data-level="7.2.3" data-path="data-frames.html"><a href="data-frames.html#eliminating-columns"><i class="fa fa-check"></i><b>7.2.3</b> Eliminating columns</a></li>
<li class="chapter" data-level="7.2.4" data-path="data-frames.html"><a href="data-frames.html#altering-column-names"><i class="fa fa-check"></i><b>7.2.4</b> Altering column names</a></li>
<li class="chapter" data-level="7.2.5" data-path="data-frames.html"><a href="data-frames.html#ordering"><i class="fa fa-check"></i><b>7.2.5</b> Ordering</a></li>
<li class="chapter" data-level="7.2.6" data-path="data-frames.html"><a href="data-frames.html#attach"><i class="fa fa-check"></i><b>7.2.6</b> <code>attach</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="data-frames.html"><a href="data-frames.html#summarizing"><i class="fa fa-check"></i><b>7.3</b> Summarizing</a></li>
<li class="chapter" data-level="7.4" data-path="data-frames.html"><a href="data-frames.html#reading-and-writing-external-data"><i class="fa fa-check"></i><b>7.4</b> Reading and writing external data</a></li>
<li class="chapter" data-level="7.5" data-path="data-frames.html"><a href="data-frames.html#exercises-4"><i class="fa fa-check"></i><b>7.5</b> Exercises</a><ul>
<li class="chapter" data-level="7.5.1" data-path="data-frames.html"><a href="data-frames.html#answer"><i class="fa fa-check"></i><b>7.5.1</b> Answer</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">raw - R Actuarial Workshops</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-frames" class="section level1">
<h1><span class="header-section-number">7</span> Data Frames</h1>
<p>This is the big one! All of that stuff about vectors and lists was prologue to this. The data frame is a seminal concept in R. Most statistical and predictive models expect one and they are the most common way to pass data in and out of R. Although critical to understand, data frames are very, very easy to get. What’s a data frame? It’s a table. That’s it. No, really, that’s it.</p>
<p>By the end of this chapter you will know the following:</p>
<ul>
<li>What’s a data frame and how do I create one?</li>
<li>How can I access and assign elements to and from a data frame?</li>
<li>How do I read and write external data?</li>
</ul>
<div id="whats-a-data-frame" class="section level2">
<h2><span class="header-section-number">7.1</span> What’s a data frame?</h2>
<p>Underneath the hood, a data frame is actually a mashup of lists and vectors. Every data frame is a list, but it’s constrained so that each list element is a vector with the same length. We can see how this exploits some of the fundamental properties of lists and vectors. Because each vector must have the same data type, there’s no danger that I’ll get character data when I only want dates or integers or whatever. At the same time, the list’s flexibility means that we can store different data types in a single data construct.</p>
<div id="creating-a-data-frame" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Creating a data frame</h3>
<p>Although there are many functions that will return a data frame, let’s construct one from scratch with the <code>data.frame</code> function. We’ll first create some vectors and then join them together.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
State &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;TX&quot;</span>, <span class="st">&quot;NY&quot;</span>, <span class="st">&quot;CA&quot;</span>), <span class="dv">10</span>)
EarnedPremium &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(<span class="kw">length</span>(State), <span class="dt">meanlog =</span> <span class="kw">log</span>(<span class="dv">50000</span>), <span class="dt">sdlog=</span><span class="dv">1</span>)
Loss &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(<span class="kw">length</span>(State), <span class="dt">meanlog =</span> <span class="kw">log</span>(<span class="dv">50000</span> *<span class="st"> </span><span class="fl">0.6</span>), <span class="dt">sdlog=</span><span class="dv">1</span>)

df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(State, EarnedPremium, Loss, <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)</code></pre></div>
<p>Note that I’ve set the “stringsAsFactors” argument to FALSE. If I hadn’t, the column “State” would be a factor, rather than a character. See <a href="#Factors">Data Types: factors</a> for some reasons why we might not want our data to be a factor.</p>
<p>We didn’t have to create the vectors before constructing the data frame. If we like, we can pass them in as the result of function calls within the call to <code>data.frame</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">State =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;TX&quot;</span>, <span class="st">&quot;NY&quot;</span>, <span class="st">&quot;CA&quot;</span>), <span class="dv">10</span>)
                 , <span class="dt">EarnedPremium =</span> <span class="kw">round</span>(<span class="kw">rlnorm</span>(<span class="kw">length</span>(State), <span class="dt">meanlog =</span> <span class="kw">log</span>(<span class="dv">50000</span>), <span class="dt">sdlog=</span><span class="dv">1</span>), <span class="dv">3</span>)
                 , <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>When constructing a data frame, there will always be some implicit metadata. For instance, every column must be named; if you don’t provide one, names will be provided for you. R will use variable names by default. If there aren’t any to be found, you’ll get the ugliness you see in the second example below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(State, EarnedPremium)
<span class="kw">names</span>(df)
<span class="co">#&gt; [1] &quot;State&quot;         &quot;EarnedPremium&quot;</span>
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;TX&quot;</span>, <span class="st">&quot;NY&quot;</span>, <span class="st">&quot;CA&quot;</span>), <span class="dv">10</span>)
                 , <span class="kw">round</span>(<span class="kw">rlnorm</span>(<span class="kw">length</span>(State), <span class="dt">meanlog =</span> <span class="kw">log</span>(<span class="dv">50000</span>), <span class="dt">sdlog=</span><span class="dv">1</span>), <span class="dv">3</span>))
<span class="kw">names</span>(df)
<span class="co">#&gt; [1] &quot;rep.c..TX....NY....CA....10.&quot;                                  </span>
<span class="co">#&gt; [2] &quot;round.rlnorm.length.State...meanlog...log.50000...sdlog...1...&quot;</span></code></pre></div>
<p>Data frames will also have dimensional attributes set automatically.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(df)
<span class="co">#&gt; [1] 30  2</span></code></pre></div>
<p>This example is small, but it doesn’t have to be. We could have a lot more rows and lot more columns. I lose focus beyond about 50 columns (i.e. once we’ve moved past column “BA” in a spreadsheet), but I’ve worked with data frames having more than one million rows on a number of occasions. Is that big data? I couldn’t say, but I’m not all that fussed about whether my data is “big” or not. The basic concept of a data frame scales incredibly well. I’ll use the same code to construct a model whether my data has 10 observations or 10 million.</p>
</div>
<div id="basic-properties-of-a-data-frame" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Basic properties of a data frame</h3>
<p>Once created, it’s straightforward to get some basic information about the data we have.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(df)
<span class="co">#&gt;  rep.c..TX....NY....CA....10.</span>
<span class="co">#&gt;  CA:10                       </span>
<span class="co">#&gt;  NY:10                       </span>
<span class="co">#&gt;  TX:10                       </span>
<span class="co">#&gt;                              </span>
<span class="co">#&gt;                              </span>
<span class="co">#&gt;                              </span>
<span class="co">#&gt;  round.rlnorm.length.State...meanlog...log.50000...sdlog...1...</span>
<span class="co">#&gt;  Min.   :  5652                                                </span>
<span class="co">#&gt;  1st Qu.: 16503                                                </span>
<span class="co">#&gt;  Median : 23835                                                </span>
<span class="co">#&gt;  Mean   : 50519                                                </span>
<span class="co">#&gt;  3rd Qu.: 35784                                                </span>
<span class="co">#&gt;  Max.   :259781</span>
<span class="kw">str</span>(df)
<span class="co">#&gt; &#39;data.frame&#39;:    30 obs. of  2 variables:</span>
<span class="co">#&gt;  $ rep.c..TX....NY....CA....10.                                  : Factor w/ 3 levels &quot;CA&quot;,&quot;NY&quot;,&quot;TX&quot;: 3 2 1 3 2 1 3 2 1 3 ...</span>
<span class="co">#&gt;  $ round.rlnorm.length.State...meanlog...log.50000...sdlog...1...: num  150554 31076 24596 30288 9805 ...</span>
<span class="kw">head</span>(df)
<span class="co">#&gt;   rep.c..TX....NY....CA....10.</span>
<span class="co">#&gt; 1                           TX</span>
<span class="co">#&gt; 2                           NY</span>
<span class="co">#&gt; 3                           CA</span>
<span class="co">#&gt; 4                           TX</span>
<span class="co">#&gt; 5                           NY</span>
<span class="co">#&gt; 6                           CA</span>
<span class="co">#&gt;   round.rlnorm.length.State...meanlog...log.50000...sdlog...1...</span>
<span class="co">#&gt; 1                                                     150553.808</span>
<span class="co">#&gt; 2                                                      31075.817</span>
<span class="co">#&gt; 3                                                      24595.979</span>
<span class="co">#&gt; 4                                                      30288.404</span>
<span class="co">#&gt; 5                                                       9805.364</span>
<span class="co">#&gt; 6                                                      15555.336</span>
<span class="kw">tail</span>(df)
<span class="co">#&gt;    rep.c..TX....NY....CA....10.</span>
<span class="co">#&gt; 25                           TX</span>
<span class="co">#&gt; 26                           NY</span>
<span class="co">#&gt; 27                           CA</span>
<span class="co">#&gt; 28                           TX</span>
<span class="co">#&gt; 29                           NY</span>
<span class="co">#&gt; 30                           CA</span>
<span class="co">#&gt;    round.rlnorm.length.State...meanlog...log.50000...sdlog...1...</span>
<span class="co">#&gt; 25                                                       42508.90</span>
<span class="co">#&gt; 26                                                       87801.52</span>
<span class="co">#&gt; 27                                                      259781.39</span>
<span class="co">#&gt; 28                                                       23073.15</span>
<span class="co">#&gt; 29                                                      249119.48</span>
<span class="co">#&gt; 30                                                       15708.70</span></code></pre></div>
<p>We can also query metadata about our data frame. Note that, for a data frame, <code>names</code> and <code>colnames</code> will return the same result. <code>dim</code> will give the number of rows and columns, or you can use <code>nrow</code> and <code>ncol</code> directly. In particular, note what result is returned by the <code>length</code> function. If you think about the fact that a data frame is actually a list, you may be able to guess why <code>length</code> returns the value it does.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(df)
<span class="co">#&gt; [1] &quot;rep.c..TX....NY....CA....10.&quot;                                  </span>
<span class="co">#&gt; [2] &quot;round.rlnorm.length.State...meanlog...log.50000...sdlog...1...&quot;</span>
<span class="kw">colnames</span>(df)
<span class="co">#&gt; [1] &quot;rep.c..TX....NY....CA....10.&quot;                                  </span>
<span class="co">#&gt; [2] &quot;round.rlnorm.length.State...meanlog...log.50000...sdlog...1...&quot;</span>
<span class="kw">dim</span>(df)
<span class="co">#&gt; [1] 30  2</span>
<span class="kw">length</span>(df)
<span class="co">#&gt; [1] 2</span>
<span class="kw">nrow</span>(df)
<span class="co">#&gt; [1] 30</span>
<span class="kw">ncol</span>(df)
<span class="co">#&gt; [1] 2</span></code></pre></div>
</div>
<div id="combining-data-frames" class="section level3">
<h3><span class="header-section-number">7.1.3</span> Combining data frames</h3>
<p>If you’ve got more than one data frame, it’s possible to combine them in several different ways: <code>rbind</code>, <code>cbind</code> and <code>merge</code>.</p>
<p><code>rbind</code> will append rows to the data frame. New rows must have the same number of columns and data types.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dfA =<span class="st"> </span>df[<span class="dv">1</span>:<span class="dv">10</span>,]
dfB =<span class="st"> </span>df[<span class="dv">11</span>:<span class="dv">20</span>, ]
<span class="kw">rbind</span>(dfA, dfB)</code></pre></div>
<p><code>cbind</code> must have the same number of rows as the data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dfC =<span class="st"> </span>dfA[, <span class="dv">1</span>:<span class="dv">2</span>]
<span class="kw">cbind</span>(dfA, dfC)
<span class="co">#&gt;    rep.c..TX....NY....CA....10.</span>
<span class="co">#&gt; 1                            TX</span>
<span class="co">#&gt; 2                            NY</span>
<span class="co">#&gt; 3                            CA</span>
<span class="co">#&gt; 4                            TX</span>
<span class="co">#&gt; 5                            NY</span>
<span class="co">#&gt; 6                            CA</span>
<span class="co">#&gt; 7                            TX</span>
<span class="co">#&gt; 8                            NY</span>
<span class="co">#&gt; 9                            CA</span>
<span class="co">#&gt; 10                           TX</span>
<span class="co">#&gt;    round.rlnorm.length.State...meanlog...log.50000...sdlog...1...</span>
<span class="co">#&gt; 1                                                      150553.808</span>
<span class="co">#&gt; 2                                                       31075.817</span>
<span class="co">#&gt; 3                                                       24595.979</span>
<span class="co">#&gt; 4                                                       30288.404</span>
<span class="co">#&gt; 5                                                        9805.364</span>
<span class="co">#&gt; 6                                                       15555.336</span>
<span class="co">#&gt; 7                                                        5651.852</span>
<span class="co">#&gt; 8                                                       13079.287</span>
<span class="co">#&gt; 9                                                       37252.876</span>
<span class="co">#&gt; 10                                                      31378.579</span>
<span class="co">#&gt;    rep.c..TX....NY....CA....10.</span>
<span class="co">#&gt; 1                            TX</span>
<span class="co">#&gt; 2                            NY</span>
<span class="co">#&gt; 3                            CA</span>
<span class="co">#&gt; 4                            TX</span>
<span class="co">#&gt; 5                            NY</span>
<span class="co">#&gt; 6                            CA</span>
<span class="co">#&gt; 7                            TX</span>
<span class="co">#&gt; 8                            NY</span>
<span class="co">#&gt; 9                            CA</span>
<span class="co">#&gt; 10                           TX</span>
<span class="co">#&gt;    round.rlnorm.length.State...meanlog...log.50000...sdlog...1...</span>
<span class="co">#&gt; 1                                                      150553.808</span>
<span class="co">#&gt; 2                                                       31075.817</span>
<span class="co">#&gt; 3                                                       24595.979</span>
<span class="co">#&gt; 4                                                       30288.404</span>
<span class="co">#&gt; 5                                                        9805.364</span>
<span class="co">#&gt; 6                                                       15555.336</span>
<span class="co">#&gt; 7                                                        5651.852</span>
<span class="co">#&gt; 8                                                       13079.287</span>
<span class="co">#&gt; 9                                                       37252.876</span>
<span class="co">#&gt; 10                                                      31378.579</span></code></pre></div>
<p><code>merge</code> is similar to a <strong>JOIN</strong> operation in a relational database. If you’re used to <strong>VLOOKUP</strong> in Excel<a href="#fn10" class="footnoteRef" id="fnref10"><sup>10</sup></a>, you’ll love <code>merge</code>. It’s possible to use multiple columns (e.g. state and effective date) when specifying how to join. If no columns are specified, <code>merge</code> will use whatever column names the two data frames have in common. Below, we merge a set of rate changes to our premium data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dfRateChange =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">State =</span> <span class="kw">c</span>(<span class="st">&quot;TX&quot;</span>, <span class="st">&quot;CA&quot;</span>, <span class="st">&quot;NY&quot;</span>), <span class="dt">RateChange =</span> <span class="kw">c</span>(.<span class="dv">05</span>, -.<span class="dv">1</span>, .<span class="dv">2</span>))
df =<span class="st"> </span><span class="kw">merge</span>(df, dfRateChange)</code></pre></div>
</div>
<div id="expand.grid" class="section level3">
<h3><span class="header-section-number">7.1.4</span> <code>expand.grid</code></h3>
<p>Consider <code>expand.grid</code>. This will create a data frame as the cartesian product (i.e. every combination of elements) of one or more vectors. Among the use cases are to check for missing data elements in another data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dfStateClass &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">State =</span> <span class="kw">c</span>(<span class="st">&quot;TX&quot;</span>, <span class="st">&quot;CA&quot;</span>, <span class="st">&quot;NY&quot;</span>)
                  , <span class="dt">Class =</span> <span class="kw">c</span>(<span class="dv">1776</span>, <span class="dv">1066</span>, <span class="dv">1492</span>))</code></pre></div>
</div>
</div>
<div id="access-and-assignment-1" class="section level2">
<h2><span class="header-section-number">7.2</span> Access and Assignment</h2>
<p>Access and assignment will feel like a weird combination of matrices and lists, though with an emphasis on the mechanics of a 2D matrix. We’ll often use the <code>[ ]</code> operator to specify which row and column we’d like. The first arugment will refer to the row and the second will refer to the column. If either argument is left blank, it will refer to every element.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[<span class="dv">1</span>, <span class="dv">2</span>]
df[<span class="dv">2</span>, ]
df[, <span class="dv">2</span>]
df[<span class="dv">2</span>, -<span class="dv">1</span>]</code></pre></div>
<p>Note the interesting case when we specify one argument but leave the other blank. I’ll wrap it in a <code>head</code> function to minimize the output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df[<span class="dv">2</span>])
<span class="co">#&gt;   round.rlnorm.length.State...meanlog...log.50000...sdlog...1...</span>
<span class="co">#&gt; 1                                                     150553.808</span>
<span class="co">#&gt; 2                                                      31075.817</span>
<span class="co">#&gt; 3                                                      24595.979</span>
<span class="co">#&gt; 4                                                      30288.404</span>
<span class="co">#&gt; 5                                                       9805.364</span>
<span class="co">#&gt; 6                                                      15555.336</span></code></pre></div>
<p>Once again, if you bear in mind that a data frame is a list, this should makes sense. Without the additional comma, R will assume that we’re dealing with a list and will respond accordingly. In this case, that means returning the second element of the list. You can extend this by requesting multiple elements of the list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df[<span class="dv">1</span>:<span class="dv">2</span>])
<span class="co">#&gt;   rep.c..TX....NY....CA....10.</span>
<span class="co">#&gt; 1                           TX</span>
<span class="co">#&gt; 2                           NY</span>
<span class="co">#&gt; 3                           CA</span>
<span class="co">#&gt; 4                           TX</span>
<span class="co">#&gt; 5                           NY</span>
<span class="co">#&gt; 6                           CA</span>
<span class="co">#&gt;   round.rlnorm.length.State...meanlog...log.50000...sdlog...1...</span>
<span class="co">#&gt; 1                                                     150553.808</span>
<span class="co">#&gt; 2                                                      31075.817</span>
<span class="co">#&gt; 3                                                      24595.979</span>
<span class="co">#&gt; 4                                                      30288.404</span>
<span class="co">#&gt; 5                                                       9805.364</span>
<span class="co">#&gt; 6                                                      15555.336</span></code></pre></div>
<p>It’ll probably be rare that you want this sort of behavior. There are many times that you’ll want to return a single vector from a data frame, but in these cases, I’d recommend either using the <code>$</code> or the <code>[[ ]]</code> operator. It’s common to use <code>$</code> to return a single column from a data frame. This will force you to use the name of the column and so provides a more expressive way to work with your data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df$EarnedPremium
<span class="kw">head</span>(df[[<span class="dv">1</span>]])
<span class="kw">head</span>(df[[<span class="st">&quot;EarnedPremium&quot;</span>]])</code></pre></div>
<p>For multiple columns, we can pass a character vector to get columns by name, rather than by position.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df[, <span class="st">&quot;EarnedPremium&quot;</span>])
<span class="co">#&gt; [1]  14953.677  65986.637 147889.324   4789.018  76795.627  82936.802</span>
<span class="kw">head</span>(df[, <span class="kw">c</span>(<span class="st">&quot;EarnedPremium&quot;</span>, <span class="st">&quot;State&quot;</span>)])
<span class="co">#&gt;   EarnedPremium State</span>
<span class="co">#&gt; 1     14953.677    TX</span>
<span class="co">#&gt; 2     65986.637    NY</span>
<span class="co">#&gt; 3    147889.324    CA</span>
<span class="co">#&gt; 4      4789.018    TX</span>
<span class="co">#&gt; 5     76795.627    NY</span>
<span class="co">#&gt; 6     82936.802    CA</span></code></pre></div>
<div id="subsetting" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Subsetting</h3>
<p>Remember that we can use the same logical and ordinal access functions which apply to vectors to access a data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dfTX =<span class="st"> </span>df[df$State ==<span class="st"> &quot;TX&quot;</span>, ]
dfBigPolicies =<span class="st"> </span>df[df$EarnedPremium &gt;=<span class="st"> </span><span class="dv">50000</span>, ]

whichState =<span class="st"> </span>(df$State ==<span class="st"> &quot;TX&quot;</span>)  
dfTX =<span class="st"> </span>df[whichState, ]

df10 &lt;-<span class="st"> </span>df[<span class="dv">1</span>:<span class="dv">10</span>, ]</code></pre></div>
<p>If I’m only looking to filter rows, an easier way would be to use the <code>subset</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dfTX =<span class="st"> </span><span class="kw">subset</span>(df, State ==<span class="st"> &quot;TX&quot;</span>)
dfBigPolicies =<span class="st"> </span><span class="kw">subset</span>(df, EarnedPremium &gt;=<span class="st"> </span><span class="dv">50000</span>)</code></pre></div>
<p>Bringing that all together, we can combine row and colum access in crazy ways. Here, we’ll get the premium and state for the rows which have losses greater than some value. Let’s say we want everything above the 80th percentile, but rounded to the nearest thousand.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">minLoss &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">quantile</span>(df$Loss, <span class="fl">0.8</span>), -<span class="dv">3</span>)
myDF &lt;-<span class="st"> </span>df[df$Loss &gt;=<span class="st"> </span>minLoss, <span class="kw">c</span>(<span class="st">&quot;EarnedPremium&quot;</span>, <span class="st">&quot;State&quot;</span>)]</code></pre></div>
</div>
<div id="altering-and-adding-columns" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Altering and adding columns</h3>
<p>We can add columns by using the same operators as for access<a href="#fn11" class="footnoteRef" id="fnref11"><sup>11</sup></a>, though it’s common practice to use <code>$</code> and the name of our new column.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df$LossRatio =<span class="st"> </span>df$Loss /<span class="st"> </span>df$EarnedPremium</code></pre></div>
<p>The <code>transform</code> will return a new data frame with transformed columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">transform</span>(df, <span class="dt">LogLoss =</span> <span class="kw">log</span>(Loss), <span class="dt">LogPremium =</span> <span class="kw">log</span>(EarnedPremium))</code></pre></div>
<p>I find <code>with</code> to be a bit easier than <code>transform</code>, however it can’t (easily) be used to create more than one column at a time. <code>with</code> will refer to the columns of a data frame in the statement where it’s called. We typically use this to return a single vector which we then assign as a new column to a data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df$LogLoss =<span class="st"> </span><span class="kw">with</span>(df, <span class="kw">log</span>(Loss))</code></pre></div>
</div>
<div id="eliminating-columns" class="section level3">
<h3><span class="header-section-number">7.2.3</span> Eliminating columns</h3>
<p>We can eliminate columns in one of two ways. If we only want to remove one column, we can assign the value NULL to it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df$LossRatio &lt;-<span class="st"> </span><span class="ot">NULL</span></code></pre></div>
<p>If we want to eliminate more than one column, we may construct a new data frame which only includes the columns we’d like to keep.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span>df[, <span class="dv">1</span>:<span class="dv">2</span>]
df &lt;-<span class="st"> </span>df[, <span class="kw">c</span>(<span class="st">&quot;State&quot;</span>, <span class="st">&quot;EarnedPremium&quot;</span>)]</code></pre></div>
<p>If we’d like to remove specific columns, Hadley Wickham <span class="citation">(Wickham, n.d.)</span> showed a nice means to do this by using set differences.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span>df[, <span class="kw">setdiff</span>(<span class="kw">colnames</span>(df), <span class="kw">c</span>(<span class="st">&quot;RateChange&quot;</span>, <span class="st">&quot;Losses&quot;</span>))]</code></pre></div>
</div>
<div id="altering-column-names" class="section level3">
<h3><span class="header-section-number">7.2.4</span> Altering column names</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df$LossRation =<span class="st"> </span><span class="kw">with</span>(df, Losses /<span class="st"> </span>EarnedPremium)
<span class="kw">colnames</span>(df)[<span class="dv">4</span>] =<span class="st"> &quot;Loss Ratio&quot;</span>
<span class="kw">colnames</span>(df)</code></pre></div>
<!-- 
### Altering, adding and removing rows

Removing rows is effectively subsetting. Alteration of particular elements of a row is 


-->
</div>
<div id="ordering" class="section level3">
<h3><span class="header-section-number">7.2.5</span> Ordering</h3>
<p>For vectors, we can use <code>sort</code> to get a sorted vector. For a data frame, we’ll need to use <code>order</code>. Remember that <code>order</code> functions a lot like <code>which</code>. It will return indices which may then be used to return specific contents.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">order</span>(df$EarnedPremium)
<span class="co">#&gt;  [1]  4 26  1 28 12 30 18 10 19 13 25  7  9  8 17 22 11 23 16 29 14 21  2</span>
<span class="co">#&gt; [24]  5 24  6 27 15  3 20</span>
df =<span class="st"> </span>df[<span class="kw">order</span>(df$EarnedPremium), ]</code></pre></div>
</div>
<div id="attach" class="section level3">
<h3><span class="header-section-number">7.2.6</span> <code>attach</code></h3>
<p>If the name of a data frame is long, typing it to access column elements might start to seem tedious. The <code>attach</code> function will alleviate this, by attaching the data frame onto something called the “search path” (which I might have described in the section on packages). What’s the search path? Well, all evidence to the contrary, R will look high and low every time you refer to something. As soon as it finds a match, it’ll proceed with whatever calculation you’ve asked it to do. Attaching the data frame to the search path means that the column names of the data frame will be added to the list of places where R will search.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(dfA)
<span class="co"># do some stuff</span>
<span class="kw">attach</span>(dfB)
<span class="co">#&gt; The following objects are masked from dfA:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     rep.c..TX....NY....CA....10.,</span>
<span class="co">#&gt;     round.rlnorm.length.State...meanlog...log.50000...sdlog...1...</span></code></pre></div>
<p>There are many references that suggest using <code>attach</code>. I don’t. I’ll actually advise against it. Why is <code>attach</code> a bad idea? If you add a number of similar data frames or packages it can quickly get hard to keep up. The worst case scenario comes when you add two data frames that share column names and you then proceed to carry out analysis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(EarnedPremium)
<span class="co">#&gt; [1] 61457.34</span></code></pre></div>
<p>Which EarnedPremium am I talking about? “Well to tell you the truth in all this excitement I kinda lost track myself.”<a href="#fn12" class="footnoteRef" id="fnref12"><sup>12</sup></a> <code>attach</code> won’t necessarily harm you. But it is a loaded gun. If you get tired of typing the name of a data frame, consider using <code>with</code>.</p>
</div>
</div>
<div id="summarizing" class="section level2">
<h2><span class="header-section-number">7.3</span> Summarizing</h2>
<p>We can use the standard suite of aggregation functions to summarize a single column of a data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(df$EarnedPremium)
<span class="co">#&gt; [1] 1843720</span>
<span class="kw">max</span>(df$EarnedPremium)
<span class="co">#&gt; [1] 559956</span></code></pre></div>
<p>For multiple columns, base R comes with the <code>aggregate</code> function. Its easiest implementation uses a formula which shows how we want the variable split. In the function below, we’re splitting earned premium by state.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aggregate</span>(EarnedPremium ~<span class="st"> </span>State, <span class="dt">data =</span> df, <span class="dt">FUN =</span> sum)
<span class="co">#&gt;   State EarnedPremium</span>
<span class="co">#&gt; 1    CA      673095.7</span>
<span class="co">#&gt; 2    NY      939215.3</span>
<span class="co">#&gt; 3    TX      231409.1</span></code></pre></div>
<p>That’s easy to type, but will only give me one column at a time. If I want multiple columns, I’ll ned to do something like the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aggregate</span>(df[, <span class="kw">c</span>(<span class="st">&quot;EarnedPremium&quot;</span>, <span class="st">&quot;Loss&quot;</span>)], <span class="dt">by =</span> df[<span class="st">&quot;State&quot;</span>], <span class="dt">FUN =</span> sum)
<span class="co">#&gt;   State EarnedPremium     Loss</span>
<span class="co">#&gt; 1    CA      673095.7 257519.6</span>
<span class="co">#&gt; 2    NY      939215.3 423081.7</span>
<span class="co">#&gt; 3    TX      231409.1 228745.6</span></code></pre></div>
<p>Although <code>aggregate</code> gets the job done, I often find it cumbersome for anything complex. Ever since I started using it, I’ve been hooked on the <code>dplyr</code> package. We’ll not go into it here, but I’ll recommend checking it out. Hover, spend a bit of time playing with <code>aggregate</code> first. There are truckloads of packages designed to make manipulation of data frames easier. They’re all powerful and they’re all a little different. I’d suggest learning the functions in base R first, then moving on to tools like <code>dplyr</code> and <code>data.table</code>. There’s a lot to be gained from understanding the problems those packages were created to solve.</p>
<!-- 
### Advanced data frame tools
  
* dplyr
* tidyr
* reshape2
* data.table
-->
</div>
<div id="reading-and-writing-external-data" class="section level2">
<h2><span class="header-section-number">7.4</span> Reading and writing external data</h2>
<p>First, we’ll write out some data. Then we’ll read it back in. The comma separated value (CSV) format is one of the easiest to work with.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write.csv</span>(df, <span class="st">&quot;SomeFile.csv&quot;</span>)</code></pre></div>
<p>To read data back in, we use the (wait for it) <code>read.csv</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myDF &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;SomeFile.csv&#39;</span>)</code></pre></div>
<p>We can use this same function to read data from the web. If it’s accessible and we’ve provided a proper URL, we can treat it the same as anything on our local file system.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">URL &lt;-<span class="st"> &quot;http://www.casact.org/research/reserve_data/ppauto_pos.csv&quot;</span>
df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(URL, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</code></pre></div>
<!--

```r
library(XML)
URL = "http://www.pro-football-reference.com/teams/nyj/2012_games.htm"
games = readHTMLTable(URL, stringsAsFactors = FALSE)
```
-->
<!-- 
### Reading from Excel

Actually there are several ways:
* XLConnect
* xlsx
* Excelsi-r


```r
library(XLConnect)
wbk = loadWorkbook("myWorkbook.xlsx")
df = readWorksheet(wbk, someSheet)
```

### Reading from a database 


```r
library(RODBC)
myChannel = odbcConnect(dsn = "MyDSN_Name")
df = sqlQuery(myChannel, "SELECT stuff FROM myTable")
```

-->
</div>
<div id="exercises-4" class="section level2">
<h2><span class="header-section-number">7.5</span> Exercises</h2>
<ul>
<li>Create a data frame with 500 rows. Include a column for policy effective date, policy expiration date and claim count. For claim count, consider using the <code>rpois</code> function to simulate from a poisson distribution.</li>
<li>Save this data to a .CSV file and then reload that file.</li>
<li>Which policy had the most claims? Which policy year?</li>
<li>Add a column for</li>
</ul>
<div id="answer" class="section level3">
<h3><span class="header-section-number">7.5.1</span> Answer</h3>
<!--
## Conclusion

Roughly 90% of your work in R will involve manipulation of data frames. 
-->

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="10">
<li id="fn10"><p>If you’ve never used VLOOKUP, I can’t imagine why you’re reading this.<a href="data-frames.html#fnref10">↩</a></p></li>
<li id="fn11"><p>We can also use <code>cbind</code> to add columns.<a href="data-frames.html#fnref11">↩</a></p></li>
<li id="fn12"><p>Copyright some film company.<a href="data-frames.html#fnref12">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lists.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["raw.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
